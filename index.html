<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="utf-8" />
    <title>4 | Box HTML Previewer</title>
    
    <link rel="stylesheet" href="https://cdn01.boxcdn.net/platform/preview/2.102.0/en-US/preview.css" />
    <script src="https://cdn01.boxcdn.net/platform/preview/2.102.0/en-US/preview.js"></script>

    <style>
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; background-color: #f5f5f5; font-family: sans-serif; }
        #preview-container { height: 100vh; width: 100vw; }
        #error-message { 
            display: none; 
            padding: 20px; 
            margin: 20px; 
            border-left: 5px solid #d8000c; 
            background-color: #ffe8e8; 
            color: #d8000c; 
        }
    </style>
</head>
<body>

    <div id="error-message"></div>
    <div id="preview-container"></div>

    <script>
        // Χρησιμοποιούμε μια μικρή καθυστέρηση για να δώσουμε χρόνο στη βιβλιοθήκη
        function startPreview() {
            const errorDiv = document.getElementById('error-message');
            const urlParams = new URLSearchParams(window.location.search);
            const fileId = urlParams.get('id');
            
            // ΠΡΟΣΟΧΗ: Βάλτε εδώ το ενεργό Developer Token σας
            const accessToken = 'Redcac57CPg17uio497IZhsCMTvDEV8I'; 

            function showCustomError(msg) {
                errorDiv.style.display = 'block';
                errorDiv.innerHTML = '<strong>⚠️ Σφάλμα:</strong> ' + msg;
            }

            // Έλεγχος αν η βιβλιοθήκη είναι έτοιμη
            if (window.Box && window.Box.ContentPreview) {
                if (!fileId) {
                    showCustomError("Λείπει το ID αρχείου από το URL (?id=...)");
                    return;
                }

                try {
                    var contentPreview = new Box.ContentPreview();
                    
                    contentPreview.addListener('error', (error) => {
                        showCustomError("Σφάλμα Box: " + error.message);
                    });

                    contentPreview.show(fileId, accessToken, {
                        container: '#preview-container',
                        showDownload: true
                    });
                } catch (e) {
                    showCustomError("Αποτυχία έναρξης: " + e.message);
                }
            } else {
                showCustomError("Η βιβλιοθήκη Box δεν είναι διαθέσιμη. Δοκιμάστε ανανέωση (F5).");
            }
        }

        // Εκτέλεση μετά τη φόρτωση της σελίδας
        window.addEventListener('load', function() {
            // Μικρή αναμονή 500ms για σιγουριά
            setTimeout(startPreview, 5000);
        });
    </script>
</body>
</html>
